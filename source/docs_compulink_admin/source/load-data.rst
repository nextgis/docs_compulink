.. sectionauthor:: Denis Rykov <denis.rykov@nextgis.com>

.. _load-data:

Загрузка данных
===============

Для массового создания ресурсов типа ``Объект строительства`` и ``Проект строительства`` предусмотрена комманда загрузки данных:


.. code:: bash

    env/bin/nextgisweb --config config.ini compulink.data_struct_import [-h] [--csv-file CSV_FILE] [--parent-res-id PARENT_RES_ID] [--only-check] [--plain-struct]


Параметры:

   --csv-file  Путь до CSV файла с исходными данными


   --parent-res-id  Идентификатор ресурса, внутри которого будет создаваться структура


   --only-check  Флаг проверки возможности загрузки данных, без реального создания


   --plain-struct  Флаг отмены создания иерархической структуры Регион-Район при создании



Для создания структуры, необходимо загрузить файл на сервер, например с помощью ssh доступа.

Файл должна содержать следующие поля:

   * region - Регион строительства
   * district - Район строительства
   * focl_name - Наименование объекта строительства
   * subcontr_name - Наименование подрядчика строительства
   * start_build_date - Дата начала строительства (в формате dd.mm.YY)
   * end_build_date - Дата окончания строительства (в формате dd.mm.YY)


.. tabularcolumns:: |p{2cm}|p{2.3cm}|p{2.6cm}|p{2.8cm}|p{2.9cm}|p{2.8cm}|
.. csv-table:: Пример таблицы с данными для создания структуры
   :header: focl_name,region,district,subcontr_name,start_build_date,end_build_date

    Покров д.,Смоленская,Гагаринский,ИТЦ,06.07.16,30.09.16
    Заборье д.,Смоленская,Демидовский,ИТЦ,06.07.16,30.09.16
    Дубровка д.,Смоленская,Демидовский,ИТЦ,06.07.16,30.09.16

Если в строке запуска указан флаг --plain-struct, то поля region и district не будут использоваться для создание иерархии ресурсов, все объекты строительства будут созданы в родительском ресурсе.